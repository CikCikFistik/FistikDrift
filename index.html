<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FistikDrift</title>

<!-- Three.js -->
<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #ccffcc;
        font-family: Arial, sans-serif;
    }

    #menu {
        position: absolute;
        inset: 0;
        background: rgba(0,0,0,0.8);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        z-index: 10;
    }

    #menu h1 {
        font-size: 50px;
        margin-bottom: 20px;
    }

    #playBtn {
        padding: 18px 50px;
        font-size: 26px;
        cursor: pointer;
        border: none;
        border-radius: 12px;
        background: #28a745;
        color: white;
        transition: 0.2s;
    }

    #playBtn:hover {
        background: #1e7e34;
    }
</style>
</head>

<body>

<div id="menu">
    <h1>FistikDrift</h1>
    <button id="playBtn">PLAY</button>
</div>

<script>
document.getElementById("playBtn").addEventListener("click", startGame);

function startGame() {

    document.getElementById("menu").style.display = "none";

    /* ---------------------------------------------------
       SCENE
    --------------------------------------------------- */
    const scene = new THREE.Scene();

    /* ---------------------------------------------------
       CAMERA
    --------------------------------------------------- */
    const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        2000
    );
    camera.position.set(0, 5, 10);

    /* ---------------------------------------------------
       RENDERER
    --------------------------------------------------- */
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    /* ---------------------------------------------------
       LIGHTS
    --------------------------------------------------- */
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(10, 20, 10);
    scene.add(light);

    const ambient = new THREE.AmbientLight(0xffffff, 0.4);
    scene.add(ambient);

    /* ---------------------------------------------------
       GROUND (ROAD)
    --------------------------------------------------- */
    const groundGeo = new THREE.PlaneGeometry(500, 500);
    const groundMat = new THREE.MeshPhongMaterial({ color: 0x222222 });
    const ground = new THREE.Mesh(groundGeo, groundMat);
    ground.rotation.x = -Math.PI / 2;
    scene.add(ground);

    /* ---------------------------------------------------
       CAR (simple cube body)
    --------------------------------------------------- */
    const carGeo = new THREE.BoxGeometry(1, 0.5, 2);
    const carMat = new THREE.MeshPhongMaterial({ color: 0xff6600 });
    const car = new THREE.Mesh(carGeo, carMat);
    car.position.y = 0.35;
    scene.add(car);

    /* ---------------------------------------------------
       CAR MOVEMENT
    --------------------------------------------------- */
    const keys = {};
    let speed = 0;
    let maxSpeed = 0.2;
    let accel = 0.01;
    let friction = 0.96;
    let turnSpeed = 0.04;

    document.addEventListener("keydown", (e) => (keys[e.key] = true));
    document.addEventListener("keyup", (e) => (keys[e.key] = false));

    function updateCar() {

        // Accelerate forward
        if (keys["w"]) speed += accel;
        // Reverse
        if (keys["s"]) speed -= accel;

        // Limit max speed
        speed *= friction;
        if (speed > maxSpeed) speed = maxSpeed;
        if (speed < -maxSpeed) speed = -maxSpeed;

        // Turning
        if (keys["a"]) car.rotation.y += turnSpeed * (speed > 0 ? 1 : -1);
        if (keys["d"]) car.rotation.y -= turnSpeed * (speed > 0 ? 1 : -1);

        // Movement + drift slight slide
        const drift = 0.05;
        car.position.x += Math.sin(car.rotation.y) * speed;
        car.position.z += Math.cos(car.rotation.y) * speed;

        // Drift lateral slide
        car.position.x += Math.sin(car.rotation.y + Math.PI / 2) * speed * drift;
        car.position.z += Math.cos(car.rotation.y + Math.PI / 2) * speed * drift;
    }

    /* ---------------------------------------------------
       CAMERA FOLLOW
    --------------------------------------------------- */
    function updateCamera() {
        const camOffset = new THREE.Vector3(0, 4, 8);
        const rotatedOffset = camOffset.clone().applyAxisAngle(
            new THREE.Vector3(0, 1, 0),
            car.rotation.y
        );

        camera.position.copy(car.position.clone().add(rotatedOffset));
        camera.lookAt(car.position);
    }

    /* ---------------------------------------------------
       ANIMATE
    --------------------------------------------------- */
    function animate() {
        requestAnimationFrame(animate);

        updateCar();
        updateCamera();

        renderer.render(scene, camera);
    }

    animate();

    /* ---------------------------------------------------
       WINDOW RESIZE FIX
    --------------------------------------------------- */
    window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
}
</script>
</body>
</html>
